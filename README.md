# CRISPR
Levenshtein Generator for CRISPR-Cas9

CRISPR-Cas9 recognizes DNA subsequences that are complementary to a short RNA sequence. In order for CAS9 to work, it requires a special Protospacer Adjacent Motif (PAM). In the case of our work, our PAM is NGG.

We use the VASim CPU simulator to build and simulate automata. To install and run VASim:

Go to lib/VASim and run 'make'
```
	cd lib/VASim
	make
```

To build the levenshtein generator (lev):

Go to lev and run 'make'
```
	cd lev
	make
```

To run the experiment, run the ./run_experiment.sh shell
./run_experiment.sh

The levenshtein directory contains the levenshtein automata generated by AutomataZoo/Levenshtein/code/lev
We generated each levenshtein automaton from the gRNA sequence with or without PAM.

1. If the source segment contains PAM, strip PAM from the source sequence:
	```
	sequences/sgRNA -> sequences/sgRNA_without_PAM

	cat sequences/sgRNA
		GTCCCTAGTGGCCCCACTGTNGG

	cat sequences/sgRNA_without_PAM
		GTCCCTAGTGGCCCCACTGT
	```

2. Generate a Levenshtein automaton from the sequence without PAM
	```
	./lev/lev -d 4 -f sequences/sgRNA_without_Pam
	lev_1_4_sgRNA_without_PAM.anml
	```

	To visualize the resulting automaton, use VASim and DOT:
	```
	./lib/VASim/vasim -d lev_1_4.anml
	dot -Tpng -o lev_1_4.png automata_0.dot
	```


3. Generate a Levenshtein automaton from the sequence with PAM by making all reporting states point to the first base in the PAM (N), and making the last G report
	```
	lev -d 4 -f sgRMA_without_Pam -p
	```

	```
	./lib/VASim/vasim -d lev_1_4.anml
	dot -Tpng -o lev_1_4.png automata_0.dot
	```


4. Translate ANML automata into MNRL automata to work with hscompile:
	```
	vasim -m lev_1_4_sgRNA_with_PAM.anml
	mv automata_0.mnrl lev_1_4_sgRNA_with_PAM.mnrl
	```

5. Compile the resulting Levenshtein + PAM automaton into a Hyperscan database with hscompile
	```
	hscompile lev_1_4_sgRNA_with_PAM.mnrl lev_1_4_sgRNA_with_PAM.hs
	```

6. Run the database against the forward-strand genome:
	```
	hsrun lev_1_4_sgRNA_with_PAM.hs 
	```
